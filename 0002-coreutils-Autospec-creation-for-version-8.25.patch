From d692c9c9dea9aee86b9ab5080580e61ac164b4bd Mon Sep 17 00:00:00 2001
From: Victor Rodriguez <victor.rodriguez.bahena@intel.com>
Date: Fri, 22 Apr 2016 23:59:04 +0000
Subject: [PATCH coreutils 2/2] coreutils: Autospec creation for version 8.25

---
 coreutils-openssl.patch | 20 ++++++++++++++++++++
 coreutils.spec          | 15 +++++++++------
 release                 |  2 +-
 used_libs               |  1 +
 4 files changed, 31 insertions(+), 7 deletions(-)
 create mode 100644 coreutils-openssl.patch

diff --git a/coreutils-openssl.patch b/coreutils-openssl.patch
new file mode 100644
index 0000000..223ab4e
--- /dev/null
+++ b/coreutils-openssl.patch
@@ -0,0 +1,20 @@
+--- coreutils.spec	2016-01-20 13:23:57.000000000 +0000
++++ coreutils-new.spec	2016-04-22 13:18:04.947321838 +0000
+@@ -16,6 +16,7 @@
+ BuildRequires : acl-dev
+ BuildRequires : attr-dev
+ BuildRequires : gmp-dev
++BuildRequires : openssl-dev
+ Patch1: 0001-df-test-Do-not-attempt-to-use-the-local-disks-during.patch
+ 
+ %description
+@@ -53,7 +54,8 @@
+ %build
+ export CFLAGS="$CFLAGS -Os -ffunction-sections "
+ export CXXFLAGS="$CXXFLAGS -Os -ffunction-sections "
+-%configure --disable-static --enable-no-install-program=kill,groups
++%configure --with-openssl --disable-static \
++           --enable-no-install-program=kill,groups
+ make V=1  %{?_smp_mflags}
+ 
+ %check
diff --git a/coreutils.spec b/coreutils.spec
index 3b9e87a..75fa2dd 100644
--- a/coreutils.spec
+++ b/coreutils.spec
@@ -4,7 +4,7 @@
 #
 Name     : coreutils
 Version  : 8.25
-Release  : 24
+Release  : 25
 URL      : http://ftp.gnu.org/gnu/coreutils/coreutils-8.25.tar.xz
 Source0  : http://ftp.gnu.org/gnu/coreutils/coreutils-8.25.tar.xz
 Summary  : No detailed summary available
@@ -17,6 +17,7 @@ BuildRequires : acl-dev
 BuildRequires : attr-dev
 BuildRequires : gmp-dev
 BuildRequires : libcap-dev
+BuildRequires : openssl-dev
 Patch1: 0001-df-test-Do-not-attempt-to-use-the-local-disks-during.patch
 
 %description
@@ -48,15 +49,17 @@ locales components for the coreutils package.
 
 
 %prep
+cd ..
 %setup -q -n coreutils-8.25
 %patch1 -p1
 
 %build
-export CFLAGS="$CFLAGS -ffunction-sections -Os "
-export FCFLAGS="$CFLAGS -ffunction-sections -Os "
-export FFLAGS="$CFLAGS -ffunction-sections -Os "
-export CXXFLAGS="$CXXFLAGS -ffunction-sections -Os "
-%configure --disable-static --enable-no-install-program=kill,groups
+export CFLAGS="$CFLAGS -Os -ffunction-sections "
+export FCFLAGS="$CFLAGS -Os -ffunction-sections "
+export FFLAGS="$CFLAGS -Os -ffunction-sections "
+export CXXFLAGS="$CXXFLAGS -Os -ffunction-sections "
+%configure --disable-static --enable-no-install-program=kill,groups \
+--with-openssl
 make V=1  %{?_smp_mflags}
 
 %check
diff --git a/release b/release
index a45fd52..7273c0f 100644
--- a/release
+++ b/release
@@ -1 +1 @@
-24
+25
diff --git a/used_libs b/used_libs
index f31b4c2..6651bc3 100644
--- a/used_libs
+++ b/used_libs
@@ -2,6 +2,7 @@ libacl.so.1
 libattr.so.1
 libc.so.6
 libcap.so.2
+libcrypto.so.1.0.0
 libgmp.so.10
 libpthread.so.0
 librt.so.1
-- 
2.8.1

